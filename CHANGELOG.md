# Changelog

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [1.0.4] - 2025-10-07

### Fixed
- **YAML形式のAI標準準拠**: wait-seconds、クォート付きステータスコード、allowed-botsの配列形式に対応
- **設定値の重複問題**: 設定値のマージロジックを書き直し、重複問題を解決
- **すべての設定をリセット**: デフォルトに戻すボタンがすべての設定値を正しくリセット
- **YAMLドキュメント区切り**: 著作権セクション前のドキュメント区切りを削除

### Changed
- **レート制限のデフォルト**: 無効化に変更（enabled: false）
- **レート制限のデフォルト値**: 5 req/sec、300 req/min に変更（従来は2/120）
- **許可ボットリスト**: 実在する9種類のボットのみに限定

### Added
- **レート制限切り替え**: チェックボックスと折りたたみ可能な詳細セクション
- **リトライポリシー切り替え**: 折りたたみ可能な詳細セクション
- **許可ボット設定フィールド**: アクセスを許可するAIボットの設定

### Improved
- **UI改善**: 表示/非表示セクションによる使いやすさの向上
- **設定処理の堅牢性**: 個別フィールド割り当てによる処理の改善

## [1.0.3] - 2025-07-09

### Added
- **キャッシュ機能**: 3時間～永久まで選択可能なキャッシュシステム
- **キャッシュクリアボタン**: 管理画面から手動でキャッシュをクリア可能
- **WordPress Transient API**: 効率的なキャッシュ実装
- **安全なテキスト出力関数**: HTMLエンティティ化を回避しつつセキュリティを確保

### Fixed
- **Plugin Check (PCP) 完全対応**: WordPress.org審査要件を完全にクリア
- **AI学習許可設定**: チェックボックス設定が正常に保存・反映されない問題を修正
- **HTMLエンティティ出力問題**: `&gt;`等が生成テキストに含まれる問題を解決
- **エスケープ処理**: テキストファイル出力で適切なエスケープ処理を実装
- **多次元配列サニタイゼーション**: YAML設定の安全な処理を改善
- **WordPress 6.8対応**: readme.txtのテスト済みバージョンを更新
- **バージョン整合性**: メインファイルとreadme.txtのバージョン統一
- **末尾スラッシュ問題**: llms.txtとllms-full.txtアクセス時のWordPress自動リダイレクト（末尾スラッシュ追加）を無効化

### Improved
- **パフォーマンス向上**: サーバー負荷を大幅に軽減
- **セキュリティ強化**: 全入出力の適切なサニタイゼーション・エスケープ処理
- **コードクオリティ**: WordPress標準関数の使用（`wp_strip_all_tags()`等）
- **エラー処理**: より堅牢な入力値検証とエラーハンドリング

### Technical
- **キャッシュシステム**: WordPress標準のTransient APIを使用した堅牢な実装
- **再帰的サニタイゼーション**: 多次元配列の安全な処理関数を実装
- **WordPress準拠**: `strip_tags()`から`wp_strip_all_tags()`への変更
- **PHPCS準拠**: 適切なコメントによるコーディング規約対応

## [1.0.2] - 2025-07-03

### Added
- **個別ファイル制御**: llms.txt と llms-full.txt の個別有効化/無効化機能
- **ファイルステータス表示**: 各ファイルの生成状況をリアルタイム表示
- **動的生成方式**: 物理ファイル保存からリアルタイム生成に変更

### Improved
- **常に最新情報**: アクセス時に最新のコンテンツ情報を提供
- **404エラー処理**: 無効化時の適切なエラーレスポンス
- **UI改善**: 生成/無効化ボタンのデザイン向上

### Changed
- **ファイル保存方式**: 物理ファイル保存を廃止し、完全動的生成に移行

## [1.0.1] - 2025-06-20

### Fixed
- **設定値処理**: 空の設定項目の正しい処理ロジックを実装
- **デフォルト値**: 適用問題の解決とバックアップ機能強化

### Improved
- **設定処理**: 設定値処理ロジックの最適化
- **エラー処理**: より堅牢なエラーハンドリング

## [1.0.0] - 2025-06-08

### Added
- **初回リリース**: WordPressプラグインとしての基本機能
- **llms.txt生成**: 概要版ファイルの動的生成機能
- **llms-full.txt生成**: 詳細版ファイルの動的生成機能
- **投稿タイプ選択**: 対象コンテンツの柔軟な選択機能
- **件数設定**: 各投稿タイプからの最大取得件数指定
- **AIクローラー設定**: YAML形式での詳細設定機能
- **制作者情報**: フッター表示のオン/オフ機能
- **UTF-8 BOM対応**: Excel等での文字化け防止
- **UTC時刻表記**: 国際標準時での日時記録
- **日本語完全対応**: すべての機能で日本語をサポート

### Technical Features
- **WordPress標準API**: WordPress推奨の実装方法を使用
- **SEO最適化**: HTMLヘッダーへのリンク自動追加
- **noindex対応**: 主要SEOプラグインとの互換性
- **セキュリティ**: 適切な入力値検証とサニタイゼーション

---

## Migration Notes

### 1.0.2 → 1.0.3
- 新しいキャッシュ機能により大幅なパフォーマンス向上
- 設定画面でキャッシュ期間を選択可能
- 既存設定は自動的に保持されます

### 1.0.1 → 1.0.2
- **重要**: 物理ファイル保存から動的生成に変更
- 既存の物理ファイル（もし存在する場合）は手動で削除してください
- パーマリンク設定の再保存を推奨

### Upgrade Process
1. プラグインファイルを更新
2. WordPress管理画面でプラグインを再有効化
3. パーマリンク設定を再保存（推奨）
4. 設定画面で新機能を確認・設定

## Compatibility

- **WordPress**: 5.0以降
- **PHP**: 7.4以降
- **ブラウザ**: Chrome, Firefox, Safari, Edge（最新2バージョン）
- **SEOプラグイン**: Yoast SEO, All in One SEO, RankMath対応

## Known Issues

現在のところ、重大な既知の問題はありません。

## Support

- **開発者**: 柏崎剛 (Tsuyoshi Kashiwazaki)
- **ウェブサイト**: https://www.tsuyoshikashiwazaki.jp/
- **バグ報告**: プラグイン設定画面またはウェブサイト経由でご報告ください
